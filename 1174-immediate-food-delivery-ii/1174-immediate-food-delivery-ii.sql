select round(avg(tb.order_date = tb.customer_pref_delivery_date )*100,2)  as immediate_percentage  from (
select * , row_number() over (partition by delivery.customer_id order by delivery.order_date) as rn from delivery )as tb where rn =1;